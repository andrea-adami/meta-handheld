From c39115ed52359eb5f0475ea2b4a2e71acb5da54b Mon Sep 17 00:00:00 2001
From: Andrea Adami <andrea.adami@gmail.com>
Date: Thu, 7 Nov 2013 23:17:36 +0100
Subject: [PATCH] cfi_util.c: force CFI detection even if Q R Y test
 fails

Signed-off-by: Andrea Adami <andrea.adami@gmail.com>
---
 drivers/mtd/chips/cfi_util.c | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/drivers/mtd/chips/cfi_util.c b/drivers/mtd/chips/cfi_util.c
index f992418..bdee7b9 100644
--- a/drivers/mtd/chips/cfi_util.c
+++ b/drivers/mtd/chips/cfi_util.c
@@ -85,7 +85,10 @@ int __xipram cfi_qry_mode_on(uint32_t base, struct map_info *map,
 	if (cfi_qry_present(map, base, cfi))
 		return 1;
 	/* QRY not found */
-	return 0;
+/*	return 0; */
+
+/*	FIXME: UGLY HACK: FORCE DETECTION */
+	return 1;
 }
 EXPORT_SYMBOL_GPL(cfi_qry_mode_on);
 
-- 
1.8.1.5

